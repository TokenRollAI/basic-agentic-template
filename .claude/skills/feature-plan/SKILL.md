---
name: feature-plan
description: 评估产品需求（PRD），分析技术可行性，提供实现方案、工作量预估和爆炸半径。当 Discussion 包含需求文档或功能规划时使用。
---

# Feature Plan 需求评估

作为高级技术架构师，分析需求文档并提供详细的技术评估报告。

## 评估流程

### 1. 需求理解

- 总结需求的**核心目标**
- 识别**关键功能点**
- 列出**边界条件**和**异常场景**
- 标记**需要澄清**的问题

### 2. 技术方案设计

提供 1-3 个可行的实现方案：

| 内容 | 描述 |
|------|------|
| 方案概述 | 简明描述技术方案 |
| 技术架构 | 架构图或组件说明 |
| 优缺点 | 客观分析 pros/cons |
| 推荐理由 | 为什么推荐此方案 |

### 3. 代码影响评估

通过代码库分析确定：

```bash
# 搜索相关模块
Grep: "相关关键词" --type ts

# 查看模块结构
Glob: "src/**/*.ts"

# 分析依赖关系
Read: package.json, 相关配置文件
```

**评估维度：**

| 维度 | 说明 |
|------|------|
| 需修改的文件 | 现有文件的修改范围 |
| 需新增的文件 | 新模块、组件、配置 |
| 受影响的功能 | 爆炸半径评估 |
| 潜在风险点 | 可能引发的问题 |

### 4. 工作量评估

**规模定义：**

| 级别 | 预估改动文件数 | 复杂度 |
|------|----------------|--------|
| `small` | 1-5 | 简单修改 |
| `medium` | 6-15 | 中等复杂度 |
| `large` | 16-30 | 较高复杂度 |
| `extra-large` | 30+ | 高复杂度/架构级变更 |

**爆炸半径定义：**

| 级别 | 描述 |
|------|------|
| `isolated` | 仅影响单一模块 |
| `contained` | 影响相关的 2-3 个模块 |
| `moderate` | 影响多个模块，需回归测试 |
| `wide` | 影响核心流程，需全面测试 |

### 5. 测试建议

- **单元测试范围**：新增/修改的函数和类
- **集成测试范围**：模块间交互点
- **E2E 测试范围**：关键用户流程
- **重点关注场景**：边界条件和异常处理

## 输出格式

### Discussion 评论模板

```markdown
## 🎯 技术评估报告

### 📋 需求摘要
{需求核心目标的一句话总结}

**关键功能点：**
1. {功能点1}
2. {功能点2}
3. {功能点3}

### 🔧 推荐方案

**方案名称**: {方案名}

**技术架构**:
{架构说明或图示}

**实现要点**:
- {要点1}
- {要点2}

**优势**: {优势说明}
**劣势**: {劣势说明}

### 📊 实现规模

| 维度 | 评估 |
|------|------|
| **工作量级别** | {small/medium/large/extra-large} |
| **预估改动文件数** | {数量} |
| **爆炸半径** | {isolated/contained/moderate/wide} |

**需修改的模块：**
- `src/module1/` - {修改说明}
- `src/module2/` - {修改说明}

**需新增的模块：**
- `src/newModule/` - {功能说明}

### ⚠️ 风险评估

| 风险 | 级别 | 缓解措施 |
|------|------|----------|
| {风险1} | 高/中/低 | {措施} |

### 📝 实现步骤

1. **{步骤1}** - `{复杂度}`
   - {详细说明}
2. **{步骤2}** - `{复杂度}`
   - {详细说明}

### 🧪 测试建议

**单元测试：**
- {测试范围}

**集成测试：**
- {测试范围}

### ❓ 待澄清问题
{如果有需要产品澄清的问题，列出}

---
🤖 由 Claude 自动生成
```

### 结构化输出 Schema

```json
{
  "requirement_summary": "需求核心摘要",
  "feature_points": ["功能点1", "功能点2"],
  "recommended_approach": {
    "name": "方案名称",
    "description": "方案描述",
    "pros": ["优势1", "优势2"],
    "cons": ["劣势1", "劣势2"]
  },
  "alternative_approaches": [
    {"name": "备选方案", "description": "描述"}
  ],
  "scope": "small|medium|large|extra-large",
  "estimated_files": 10,
  "affected_modules": ["module1", "module2"],
  "blast_radius": "isolated|contained|moderate|wide",
  "risks": ["风险1", "风险2"],
  "implementation_steps": [
    {"step": "步骤描述", "complexity": "simple|moderate|complex"}
  ],
  "clarification_needed": ["问题1", "问题2"]
}
```

## 注意事项

- 所有输出使用**简体中文**
- 基于**实际代码库**给出具体建议
- 如果需求不清晰，明确指出**需要澄清的点**
- 使用 `gh api` 在 Discussion 下发布评论
